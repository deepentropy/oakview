(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[49021,73105],{662887:e=>{e.exports={}},405942:(e,t,s)=>{"use strict";s.d(t,{numOfDecimalPlaces:()=>r});var n=s(960521),i=s.n(n);function r(e){return(new(i())(e).toFixed().split(".")[1]||"").length}},745269:(e,t,s)=>{"use strict";s.d(t,{CubicBezier:()=>r,color:()=>o,dur:()=>n,easingFunc:()=>i});const n=350,i={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:(4-2*e)*e-1,easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeInOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1- --e*e*e*e,easeInOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1+--e*e*e*e*e,easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e};class r{constructor(e,t,s,n){this._mX1=e,this._mY1=t,this._mX2=s,this._mY2=n}easingFunc(e){return this._mX1===this._mY1&&this._mX2===this._mY2?e:this._calcBezier(this._getTForX(e))}_a(e,t){return 1-3*t+3*e}_b(e,t){return 3*t-6*e}_c(e){return 3*e}_calcBezier(e){return((this._a(this._mY1,this._mY2)*e+this._b(this._mY1,this._mY2))*e+this._c(this._mY1))*e}_getSlope(e){return 3*this._a(this._mX1,this._mX2)*e*e+2*this._b(this._mX1,this._mX2)*e+this._c(this._mX1)}_getTForX(e){let t=e;for(let s=0;s<4;++s){const s=this._getSlope(t);if(0===s)return t;t-=(this._calcBezier(t)-e)/s}return t}}const o={black70:"#4A4A4A",black80:"#535353"}},746326:(e,t,s)=>{"use strict";function n(e){const{paddingTop:t,paddingBottom:s}=window.getComputedStyle(e);return[t,s].reduce(((e,t)=>e-Number((t||"").replace("px",""))),e.clientHeight)}function i(e,t=!1){const s=getComputedStyle(e),n=[s.height];return"border-box"!==s.boxSizing&&n.push(s.paddingTop,s.paddingBottom,s.borderTopWidth,s.borderBottomWidth),t&&n.push(s.marginTop,s.marginBottom),n.reduce(((e,t)=>e+(parseFloat(t)||0)),0)}function r(e,t=!1){const s=getComputedStyle(e),n=[s.width];return"border-box"!==s.boxSizing&&n.push(s.paddingLeft,s.paddingRight,s.borderLeftWidth,s.borderRightWidth),t&&n.push(s.marginLeft,s.marginRight),n.reduce(((e,t)=>e+(parseFloat(t)||0)),0)}s.d(t,{contentHeight:()=>n,outerHeight:()=>i,outerWidth:()=>r})},274210:(e,t,s)=>{"use strict";s.d(t,{QUOTE_FIELDS:()=>i,QUOTE_FIELDS_CACHE:()=>r});var n=s(650151)
;const i=new Set(["pro_name","base_name","logoid","currency-logoid","base-currency-logoid","source-logoid","short_name","web_site_url","pro_perm","timezone","current_session","last_price","lp_time","subsessions","prev_close_price","open_price","high_price","low_price","price_52_week_high","price_52_week_low","ask","ask_size","bid","bid_size","rch","rchp","rtc","rtc_time","data_frequency","reference-last-period-start","business_description","web_site_url","figi","number_of_employees","float_shares_outstanding","earnings_release_next_calendar_date","root","description","exchange","listed_exchange","type","country_code","provider_id","sector","typespecs","visible-plots-set","industry","currency_id","last_price","fractional","minmov","minmove2","pricescale","variable_tick_size","change","change_percent","volume","average_volume","market_cap_basic","market_cap_calc","total_revenue","earnings_per_share_basic_ttm","price_earnings_ttm","beta_1_year","dps_common_stock_prim_issue_fy","dividends_yield","earnings_release_next_date","earnings_per_share_forecast_next_fq","earnings_publication_type_next_fq","earnings_release_date","earnings_per_share_fq","earnings_per_share_forecast_fq","forecast_raw","last_release_date","next_release_date","reference_last_period","fundamental_currency_code","number_of_employees","web_site_url","business_description","founded","ceo","float_shares_outstanding","total_shares_outstanding","dividend_payout_ratio_ttm","dividends_yield_current","dividend_ex_date_upcoming","dividend_amount_upcoming","dividend_amount_recent","dividend_ex_date_recent","dividend_amount_h","dividend_payment_date_upcoming","dividend_payment_date_recent","total_revenue_fq_h","total_revenue_fy_h","net_income_fy_h","net_income_fq_h","total_assets_fy_h","total_assets_fq_h","total_liabilities_fy_h","total_liabilities_fq_h","cash_f_operating_activities_fy_h","cash_f_operating_activities_fq_h","cash_f_investing_activities_fy_h","cash_f_investing_activities_fq_h","cash_f_financing_activities_fy_h","cash_f_financing_activities_fq_h","fiscal_period_fy_h","fiscal_period_fq_h","fiscal_period_fh_h","earnings_release_date_fq_h","earnings_release_next_date_fq","earnings_per_share_forecast_next_fq","earnings_per_share_forecast_fq_h","earnings_per_share_fq_h","earnings_fiscal_period_fq_h","next_earnings_fiscal_period_fq","is_next_earnings_release_date_estimated","symbol-primaryname","currency_code","rates_mc","rates_fy","rates_ttm","measure","value_unit_id","value-unit-id","update_mode","language","local_description","short_description","source","source2","format","recommendation_mark","last_report_frequency","price_target_estimates_num","price_target_average","update_mode_seconds","recommendation_total","recommendation_buy","recommendation_over","recommendation_hold","recommendation_under","recommendation_sell","recommendation_total","price_target_high","price_target_low","rates_pt","rates_pt","total_revenue_fy_h","total_revenue_fq_h","total_revenue_fh_h","net_income_fy_h","net_income_fq_h","net_income_fh_h","total_assets_fy_h","total_assets_fq_h","total_assets_fh_h","total_liabilities_fy_h","total_liabilities_fq_h","total_liabilities_fh_h","cash_f_operating_activities_fy_h","cash_f_operating_activities_fq_h","cash_f_operating_activities_fh_h","cash_f_investing_activities_fy_h","cash_f_investing_activities_fq_h","cash_f_investing_activities_fh_h","cash_f_financing_activities_fy_h","cash_f_financing_activities_fq_h","cash_f_financing_activities_fh_h","fiscal_period_fy","fiscal_period_fq","fiscal_period_fh","earnings_release_date_fq_h","earnings_release_date_fy_h","earnings_release_date_fh_h","earnings_release_next_date_fq","earnings_release_next_date_fy","earnings_release_next_date_fh","earnings_release_next_time","earnings_release_time","is_next_earnings_release_date_estimated","earnings_per_share_forecast_next_fq","earnings_per_share_forecast_next_fy","earnings_per_share_forecast_next_fh","earnings_per_share_forecast_fq_h","earnings_per_share_forecast_fy_h","earnings_per_share_forecast_fh_h","earnings_per_share_fq_h","earnings_per_share_fy_h","earnings_per_share_fh_h","earnings_fiscal_period_fq_h","earnings_fiscal_period_fy_h","earnings_fiscal_period_fh_h","next_earnings_fiscal_period_fq","next_earnings_fiscal_period_fy","next_earnings_fiscal_period_fh","revenue_fq_h","revenue_fy_h","revenue_fh_h","revenue_forecast_fq_h","revenue_forecast_fy_h","revenue_forecast_fh_h","revenue_forecast_next_fq","revenue_forecast_next_fy","revenue_forecast_next_fh","revenue_seg_by_business_h","revenue_seg_by_region_h","total_revenue_fy","total_revenue_fq","total_revenue_fh","gross_profit_fy","gross_profit_fq","gross_profit_fh","ebitda_fy","ebit_fy","net_income_fy","net_income_fq","net_income_fh","total_debt_fy_h","total_debt_fq_h","total_debt_fh_h","free_cash_flow_fy_h","free_cash_flow_fq_h","free_cash_flow_fh_h","cash_n_equivalents_fy_h","cash_n_equivalents_fq_h","cash_n_equivalents_fh_h","total_current_assets_fy","total_current_assets_fq","total_current_assets_fh","total_current_liabilities_fy","total_current_liabilities_fq","total_current_liabilities_fh","total_non_current_assets_fy","total_non_current_assets_fq","total_non_current_assets_fh","total_non_current_liabilities_fy","total_non_current_liabilities_fq","total_non_current_liabilities_fh","loans_net_fy","loans_net_fy_h","loans_net_fq_h","loans_net_fh_h","total_deposits_fy","total_deposits_fy_h","total_deposits_fq_h","total_deposits_fh_h","loan_loss_allowances_fy","loan_loss_allowances_fy_h","loan_loss_allowances_fq_h","loan_loss_allowances_fh_h","reserve_to_total_capital_fy_h","reserve_to_total_capital_fq_h","reserve_to_total_capital_fh_h","unearned_premium_to_total_capital_fy_h","unearned_premium_to_total_capital_fq_h","unearned_premium_to_total_capital_fh_h","insurance_reserves_fy_h","insurance_reserves_fq_h","insurance_reserves_fh_h","policy_claims_fy_h","policy_claims_fq_h","policy_claims_fh_h","premiums_earned_fy_h","premiums_earned_fq_h","premiums_earned_fh_h","price_earnings_fq_h","price_earnings_fy_h","price_earnings_fh_h","price_sales_fq_h","price_sales_fy_h","price_sales_fh_h","diluted_net_income_ttm","total_revenue_ttm","price_earnings_current","price_sales_current","isin-displayed","cusip","interest_income_fy_h","interest_income_fq_h","interest_income_fh_h","non_interest_income_fy_h","non_interest_income_fq_h","non_interest_income_fh_h","website","doc","explorer","sources","contracts","crypto_common_categories","crypto_asset","community","dividends_availability","earnings_availability","financials_availability","documents","etf_asset_type_exposure","etf_region_exposure","top_holdings","unit-id","options-info","interest_income_fy","interest_income_fq","interest_income_fh","non_interest_income_fy","non_interest_income_fq","non_interest_income_fh","interest_expense_fy","interest_expense_fq","interest_expense_fh","loan_loss_provision_fy","loan_loss_provision_fq","loan_loss_provision_fh","non_interest_expense_fy","non_interest_expense_fq","non_interest_expense_fh","non_oper_income_fy","non_oper_income_fq","non_oper_income_fh","unusual_expense_inc_fy","unusual_expense_inc_fq","unusual_expense_inc_fh","pretax_income_fy","pretax_income_fq","pretax_income_fh","income_tax_fy","income_tax_fq","income_tax_fh","after_tax_other_income_fy","after_tax_other_income_fq","after_tax_other_income_fh","total_non_oper_income_fy","total_non_oper_income_fq","total_non_oper_income_fh","oper_income_fy","oper_income_fq","oper_income_fh","operating_expenses_fy","operating_expenses_fq","operating_expenses_fh","cost_of_goods_fy","cost_of_goods_fq","cost_of_goods_fh","equity_in_earnings_fy","equity_in_earnings_fq","equity_in_earnings_fh","minority_interest_exp_fy","minority_interest_exp_fq","minority_interest_exp_fh","discontinued_operations_fy","discontinued_operations_fq","discontinued_operations_fh","front_contract","pointvalue","unit_id","expiration","aum","asset_class","focus","expense_ratio","launch_date","issuer","brand","homepage","index_tracked","actively_managed","fund_view_mode","common_equity_tier1_ratio_fy_h","common_equity_tier1_ratio_fq_h","common_equity_tier1_ratio_fh_h","tier1_capital_ratio_fy_h","tier1_capital_ratio_fq_h","tier1_capital_ratio_fh_h","total_capital_ratio_fy_h","total_capital_ratio_fq_h","total_capital_ratio_fh_h","preferred_stock_carrying_value_fh","preferred_stock_carrying_value_fq","total_debt_fq","minority_interest_fh","minority_interest_fq","cash_n_short_term_invest_fq","cash_n_due_f_banks_fh","cash_n_due_f_banks_fq","enterprise_value_current","etf_holdings_count","contract-description","reference-last-period","all_time_high","all_time_high_day","all_time_low","all_time_low_day","outstanding_amount","nominal_value","denom_min","current_coupon","coupon_type_general","coupon_frequency","yield_to_maturity","maturity-date","days_to_maturity","bond_issuer","issue_date","bond_issuer_stock_symbol","total_issued_amount","paid_amount","bond_snp_rating_lt_h","placement_type","duration_type","maturity_type","offer_type","redemption_type","conversion_option","sinking_fund","ownership_form","daily-summary-ast","issue_status","coupon_h","sinking_fund_next_date","sinking_fund_min_amount_next","call_next_date","redemptions_h","call_notice_days","put_next_date","put_notice_days_min","seniority_level","inflation_protection","pledge_status","bond_issuer_country_of_risk","bond_issuer_cr_parent","credit_enhancement_type","credit_enhancement_status","use_of_proceeds","bond_issuer_snp_rating_lt_h","bond_issuer_snp_rating_st_h","bond_agents_tr","first_bar_time_1d","financial-indicator-id","exchange-info","underlying-symbol","strike","lotsize","option-style","has_bonds","open_time","has_bonds","dex_buys_15m","dex_sells_15m","dex_buy_volume_15m","dex_sell_volume_15m","dex_buyers_15m","dex_sellers_15m","dex_buys_1h","dex_sells_1h","dex_buy_volume_1h","dex_sell_volume_1h","dex_buyers_1h","dex_sellers_1h","dex_buys_4h","dex_sells_4h","dex_buy_volume_4h","dex_sell_volume_4h","dex_buyers_4h","dex_sellers_4h","dex_buys_12h","dex_sells_12h","dex_buy_volume_12h","dex_sell_volume_12h","dex_buyers_12h","dex_sellers_12h","dex_buys_24h","dex_sells_24h","dex_buy_volume_24h","dex_sell_volume_24h","dex_buyers_24h","dex_sellers_24h","dex_converted_symbol","dex_trading_volume_24h","dex_created_time","dex_currency","dex_currency_logoid","blockchain_addresses_urls","blockchain_addresses","base_currency","available_data_range_begin_date","available_data_range_end_date","has_etf_ownership","symbol_primary_listing"]),r=new class{
constructor(e){this._cache=new Map,this._times=new Map,this._fields=[...e.fields]}update(e,t,s){const i=(0,n.ensureDefined)(e.symbolname),r=Date.now();if(this._cache.has(i)||this._cache.set(i,{symbolname:i,status:e.status,values:{}}),this._times.has(i)||this._times.set(i,new Map),"error"===e.status)return;const o=(0,n.ensureDefined)(this._cache.get(i)),a=(0,n.ensureDefined)(this._times.get(i));o.status=e.status;for(const n of this._fields)t.has(n)&&(s||void 0!==e.values[n])&&(o.values[n]=e.values[n],a.set(n,r))}get(e){return this._cache.get(e)??null}getTimes(e){return this._times.get(e)??null}fields(){return this._fields}}({fields:i})},372988:(e,t,s)=>{"use strict";s.d(t,{getNewPeveCloseMode:()=>r,setNewPrevCloseMode:()=>i});let n=!1;function i(e){n=e}function r(){return n}},332906:(e,t,s)=>{"use strict";s.d(t,{QuoteSession:()=>i});var n=s(900608);class i{constructor(e,t=(0,n.randomHash)()){this._sessionstarted=!1,this._globalHandler=null,this._chartApi=e,this._sessionid="qs_"+t}destroy(){this._sessionstarted&&(this._chartApi.quoteDeleteSession(this._sessionid),this._sessionstarted=!1)}connected(){return this._chartApi.connected()}connect(e){this._globalHandler=e,this._chartApi.createSession(this._sessionid,this),this._chartApi.connect()}disconnect(){this._chartApi.disconnect()}quoteAddSymbols(e){this._chartApi.quoteAddSymbols(this._sessionid,e)}quoteRemoveSymbols(e){this._chartApi.quoteRemoveSymbols(this._sessionid,e)}quoteFastSymbols(e){this._chartApi.quoteFastSymbols(this._sessionid,e)}quoteSetFields(e){this._chartApi.quoteSetFields(this._sessionid,e)}onMessage(e){switch(e.method){case"connected":this._sessionstarted||(this._chartApi.quoteCreateSession(this._sessionid),this._sessionstarted=!0);break;case"disconnected":this._sessionstarted=!1}this._globalHandler?.(e)}quoteHibernateAll(){this._chartApi.quoteHibernateAll(this._sessionid)}}},761637:(e,t,s)=>{"use strict";function n(e){if(void 0===e)return null;const t=e.match(/(delayed_streaming)_(\d+)/);return null===t?null:{mode:t[1],interval:parseInt(t[2])}}function i(e){const t=n(e.update_mode);return null===t||(e.update_mode=t.mode,e.update_mode_seconds=t.interval),e}s.d(t,{normalizeUpdateMode:()=>i,parseUpdateMode:()=>n})},404573:(e,t,s)=>{"use strict";s.d(t,{Draggable:()=>r,PointerBackend:()=>o});var n=s(650151),i=s(318557);s(662887);class r{constructor(e){this._helper=null,this._handleDragStart=e=>{if(null!==this._helper)return;const t=this._source;t.classList.add("ui-draggable-dragging");const[s,n]=[(0,i.outerWidth)(t),(0,i.outerHeight)(t)];this._helper={startTop:parseFloat(t.style.top)||0,startLeft:parseFloat(t.style.left)||0,nextTop:null,nextLeft:null,raf:null,size:[s,n],
containment:this._containment instanceof HTMLElement?[parseInt(getComputedStyle(this._containment).borderLeftWidth)+parseInt(getComputedStyle(this._containment).paddingLeft),parseInt(getComputedStyle(this._containment).borderTopWidth)+parseInt(getComputedStyle(this._containment).paddingTop),this._containment.offsetWidth-parseInt(getComputedStyle(this._containment).borderRightWidth)-parseInt(getComputedStyle(this._containment).paddingRight)-parseInt(getComputedStyle(t).marginLeft)-parseInt(getComputedStyle(t).marginRight)-s,this._containment.offsetHeight-parseInt(getComputedStyle(this._containment).borderBottomWidth)-parseInt(getComputedStyle(this._containment).paddingBottom)-parseInt(getComputedStyle(t).marginTop)-parseInt(getComputedStyle(t).marginBottom)-n]:"window"===this._containment?[window.scrollX,window.scrollY,window.scrollX+document.documentElement.offsetWidth-s,window.scrollY+document.documentElement.offsetHeight-n]:null},this._start?.()},this._handleDragMove=e=>{if(null===this._helper)return;const{current:t,initial:s}=e.detail,n=this._source,i=this._helper.nextTop,r=this._helper.nextLeft,o="y"===this._axis||!1===this._axis||0!==t.movementY;if(o){const e=this._helper.startTop;isFinite(e)&&(this._helper.nextTop=t.clientY-s.clientY+e)}const a="x"===this._axis||!1===this._axis||0!==t.movementY;if(a){const e=this._helper.startLeft;isFinite(e)&&(this._helper.nextLeft=t.clientX-s.clientX+e)}if(null!==this._helper.containment){const[e,t,s,n]=this._helper.containment;o&&this._helper.nextTop&&(this._helper.nextTop=Math.min(this._helper.nextTop,n),this._helper.nextTop=Math.max(this._helper.nextTop,t)),a&&this._helper.nextLeft&&(this._helper.nextLeft=Math.min(this._helper.nextLeft,s),this._helper.nextLeft=Math.max(this._helper.nextLeft,e))}null!==this._helper.raf||i===this._helper.nextTop&&r===this._helper.nextLeft||(this._helper.raf=requestAnimationFrame((()=>{null!==this._helper&&(null!==this._helper.nextTop&&(n.style.top=this._helper.nextTop+"px",this._helper.nextTop=null),null!==this._helper.nextLeft&&(n.style.left=this._helper.nextLeft+"px",this._helper.nextLeft=null),this._helper.raf=null)}))),this._drag?.()},this._handleDragStop=e=>{if(null===this._helper)return;this._source.classList.remove("ui-draggable-dragging"),this._helper=null,this._stop?.()};const t=this._source=e.source;t.classList.add("ui-draggable");const s=this._handle=(e.handle?t.querySelector(e.handle):null)??t;s.classList.add("ui-draggable-handle"),this._start=e.start,this._stop=e.stop,this._drag=e.drag,this._backend=new o({handle:s,onDragStart:this._handleDragStart,onDragMove:this._handleDragMove,onDragStop:this._handleDragStop}),this._axis=e.axis??!1,this._containment=e.containment}destroy(){const e=this._source;e.classList.remove("ui-draggable"),e.classList.remove("ui-draggable-dragging");this._handle.classList.remove("ui-draggable-handle"),this._backend.destroy(),null!==this._helper&&(this._helper.raf&&cancelAnimationFrame(this._helper.raf),this._helper=null)}}class o{constructor(e){this._pointerStarted=!1,this._initial=null,
this._handlePointerDown=e=>{if(null!==this._initial||0!==e.button)return;if(!(e.target instanceof Element&&this._handle.contains(e.target)))return;if(this._initial=e,!this._distance&&(this._pointerStart(),!this._pointerStarted))return;e.preventDefault();const t=this._getEventTarget();t.addEventListener("pointermove",this._handlePointerMove),t.addEventListener("pointerup",this._handlePointerUp),t.addEventListener("pointercancel",this._handlePointerUp),t.addEventListener("lostpointercapture",this._handleLostPointerCapture)},this._handleLostPointerCapture=e=>{this._getEventTarget()===e.target&&this._handlePointerUp(e)},this._handlePointerMove=e=>{if(null!==this._initial&&this._initial.pointerId===e.pointerId)if(this._pointerStarted)this._pointerDrag(e);else if(this._pointerDistanceMet(e)){if(this._pointerStart(),this._pointerStarted)return void this._pointerDrag(e);this._handlePointerUp(e)}},this._handlePointerUp=e=>{if(null===this._initial||this._initial.pointerId!==e.pointerId)return;e.preventDefault();const t=this._getEventTarget();t.removeEventListener("pointermove",this._handlePointerMove),t.removeEventListener("pointerup",this._handlePointerUp),t.removeEventListener("pointercancel",this._handlePointerUp),t.removeEventListener("lostpointercapture",this._handlePointerUp),this._pointerStarted&&(this._pointerStarted=!1,t.releasePointerCapture(this._initial.pointerId),this._dispatchEvent(this._createEvent("pointer-drag-stop",e))),this._initial=null};const t=this._handle=e.handle;this._onDragStart=e.onDragStart,this._onDragMove=e.onDragMove,this._onDragStop=e.onDragStop,this._distance=e.distance??0,this._rootElement=e.rootElement,t.style.touchAction="none",t.addEventListener("pointerdown",this._handlePointerDown)}destroy(){const e=this._handle;e.style.touchAction="",e.removeEventListener("pointerdown",this._handlePointerDown),e.removeEventListener("pointermove",this._handlePointerMove),e.removeEventListener("pointerup",this._handlePointerUp),e.removeEventListener("pointercancel",this._handlePointerUp),e.removeEventListener("lostpointercapture",this._handlePointerUp),null!==this._initial&&(e.releasePointerCapture(this._initial.pointerId),this._initial=null),this._pointerStarted=!1}_pointerStart(){if(!this._initial)return;const e=this._getEventTarget();this._dispatchEvent(this._createEvent("pointer-drag-start",this._initial))?(this._pointerStarted=!0,e.setPointerCapture(this._initial.pointerId)):this._initial=null}_pointerDrag(e){e.preventDefault(),this._dispatchEvent(this._createEvent("pointer-drag-move",e))}_pointerDistanceMet(e){return!this._initial||!this._distance||Math.max(Math.abs(this._initial.clientX-e.clientX),Math.abs(this._initial.clientY-e.clientY))>=this._distance}_getEventTarget(){return this._rootElement??this._handle}_dispatchEvent(e){switch(e.type){case"pointer-drag-start":this._onDragStart(e);break;case"pointer-drag-move":this._onDragMove(e);break;case"pointer-drag-stop":this._onDragStop(e)}return!e.defaultPrevented}_createEvent(e,t){return(0,n.assert)(null!==this._initial),new CustomEvent(e,{
bubbles:!0,cancelable:!0,detail:{backend:this,initial:this._initial,current:t}})}}},833813:(e,t,s)=>{"use strict";var n;s.d(t,{ProductFeaturesEnum:()=>n,UNLIMITED_FEATURE_LIMIT:()=>i}),function(e){e.CAN_EDIT_PUBLIC_CHATS="CAN_EDIT_PUBLIC_CHATS",e.NO_SPONSORED_ADS="NO_SPONSORED_ADS",e.ALERTS_NO_EXPIRATION="ALERTS_NO_EXPIRATION",e.ALERTS_WEBHOOK="ALERTS_WEBHOOK",e.SCREENER_AUTO_REFRESH="SCREENER_AUTO_REFRESH",e.SCREENER_INTERVALS="SCREENER_INTERVALS",e.SCREENER_EXPORT_DATA="SCREENER_EXPORT_DATA",e.SOCIAL_ACTIVITY="SOCIAL_ACTIVITY"}(n||(n={}));const i=99999},262078:(e,t,s)=>{"use strict";s.r(t),s.d(t,{pushStreamMultiplexer:()=>F});var n=s(226722),i=s(345848),r=s(49437),o=s(666054),a=s(175203),_=s(735566),h=s(650151),c=s(798266),l=s(420021);class u{constructor(e){this._queue=[],this._isWorking=!1,this._onResolve=()=>{this._queue.length>0&&this._createPromise(this._queue[0])},this._logger=e}enqueue(e){this._logger.logNormal(`Adding channel in stack. Queue size: ${this._queue.length}`),this._isWorking||this._createPromise(e),this._queue.push(e)}_createPromise(e){this._isWorking=!0,this._wrap(e).then(this._onResolve)}_wrap(e){return new Promise((t=>{e().catch((e=>this._logger.logNormal(`Error when trying handling channel: ${e.message}`))).finally((()=>{this._isWorking=!1,this._queue.shift(),t()}))}))}}const d="PushStream",m=(0,_.getLogger)(d);var p;!function(e){e[e.EventSource=0]="EventSource",e[e.WebSocket=1]="WebSocket"}(p||(p={}));class f{constructor(e,t){this._channels=[],this._queue=new u(m),this._transport=t.transportType===p.EventSource?new c.PersistentEventSourceTransport(this._onPushStreamMessage.bind(this)):new l.PersistentWebsocketTransport(this._onPushStreamMessage.bind(this),this._onPushStreamClose.bind(this)),this._settings=t,this._messageHandler=e}addChannel(e){this._queue.enqueue((()=>this._addChannel(e)))}removeChannel(e){this._queue.enqueue((()=>this._removeChannel(e)))}getChannels(){return this._channels}hasChannel(e){return-1!==this._channels.indexOf(e)}connectionStatus(){return this._transport.connectionStatus()}reconnectEvent(){return this._transport.successReconnectReachedEvent()}connect(){(0,h.assert)(0!==this._channels.length,"There is no channels"),this._transport.connect()}disconnect(){this._transport.disconnect()}getLogs(e){return(0,_.getRawLogHistory)(e,d)}async _addChannel(e){(0,h.assert)(!this.hasChannel(e),`Channel with name ${e} has already been subscribed`),m.logNormal(`Adding channel ${e}`),this._channels.push(e);const{maxSize:t}=this._settings;return void 0!==t&&this._channels.length>t&&(this._channels=this._channels.slice(this._channels.length-t)),this._transport.setUrl(this._generateUrl())}async _removeChannel(e){const t=this._channels.indexOf(e);return(0,h.assert)(-1!==t,`There is no channel with name ${e}`),m.logNormal(`Removing channel ${e}`),this._channels.splice(t,1),this._transport.setUrl(this._generateUrl())}_onPushStreamMessage(e){if("string"!=typeof e)throw new Error("Wrong message type, expected string");const t=JSON.parse(e),s=t.id,n=t.channel
;-2===s?m.logWarn("Received unexpected message: about removed the channel"):s>0&&(m.logDebug(`Received message: id="${s}" channel="${n}"`),this._messageHandler(t.text,s,n))}_onPushStreamClose(e){1005===e.code&&a.telemetry.sendChartReport("websocket_code_1005")}_generateUrl(){const e=this._channels.join("/");return m.logNormal(`Generate pushstream url - ${e}`),`${this._settings.url}/${this._settings.urlPath}/${e}`}}s(659863);class g{constructor(){this._handlers={},this._specialHandlers={}}on(e,t){const s=this._isSpecialChannel(e)?this._specialHandlers:this._handlers;s[e]||(s[e]=[]),s[e].push(t)}off(e,t){const s=this._isSpecialChannel(e)?this._specialHandlers:this._handlers;if(!(e in s))return;if(void 0===t)return void delete s[e];const n=s[e].indexOf(t);n>=0&&s[e].splice(n,1)}emit(e,t,s,n){this._handlers[s]&&this._handlers[s].forEach((i=>{i(e,t,s,n)}));for(const i of Object.keys(this._specialHandlers)){const r="^"+i.replace(/\*/g,".*?")+"$";new RegExp(r).test(s)&&this._specialHandlers[i].forEach((i=>{i(e,t,s,n)}))}}_isSpecialChannel(e){return/\*/.test(e)}}var v=s(125226),b=s(900608),y=s(314802),S=s(251924),C=s(197188),w=s(23482);function E(){return!w.isIOS&&!w.isIPad&&void 0!==navigator.locks}class x{constructor(){this._id=(0,b.guid)(),this._state={[this._id]:{}},this._xEventPrefix="multiplexer-state-",this._xEventCreateTab=this._xEventPrefix+"create-new-tab",this._xEventShareState=this._xEventPrefix+"share-state",this._lockName="tab_destruction",this._stateChangeDelegate=new S.Delegate,this._createdLocks={},this._lockEnabled=E(),this._lockPromise=(0,C.createDeferredPromise)(),this._lockCreated=(0,C.createDeferredPromise)(),this._onTabCreateCb=null,this._onTabCreate=e=>{this._onTabCreateCb&&this._onTabCreateCb();const t=JSON.parse(e);this._state[t]={},this._shareState(),this._requestTabRemoveLock(t)},this._shareState=async()=>{await this._lockCreated.promise;const e=JSON.stringify([this._id,this._state[this._id]]);n.TVXWindowEvents.emit(this._xEventShareState,e)},this._requestTabRemoveLock=e=>{!this._createdLocks[e]&&this._lockEnabled&&(this._createdLocks[e]=1,navigator.locks.request(`${this._lockName}_${e}`,(async()=>{const t=this._state[e]||{};this._compareTabState(e,{},t,"add"),this._compareTabState(e,t,{},"remove"),delete this._state[e],delete this._createdLocks[e]})))},this._onShareStateFromOther=e=>{const[t,s]=JSON.parse(e),n=this._state[t]||{};this._compareTabState(t,s,n,"add"),this._compareTabState(t,n,s,"remove"),this._state[t]=s,this._requestTabRemoveLock(t)},this._removeChannel=(e,t)=>{delete this._state[this._id][e][t],this._isListenByAnotherTab(e,t)||this._stateChangeDelegate.fire("remove",e,t);0===Object.keys(this._state[this._id][e]).length&&delete this._state[this._id][e]},n.TVXWindowEvents.on(this._xEventCreateTab,this._onTabCreate),n.TVXWindowEvents.on(this._xEventShareState,this._onShareStateFromOther),this._lockEnabled?navigator.locks.request(`${this._lockName}_${this._id}`,(async()=>(n.TVXWindowEvents.emit(this._xEventCreateTab,JSON.stringify(this._id)),
window.addEventListener("beforeunload",(()=>this._lockPromise.resolve())),this._lockCreated.resolve(),this._lockPromise.promise))):this._lockCreated.resolve()}addChannel(e,t){this._isNotEmpty(e,t)?this._state[this._id][e][t]++:(this._state[this._id][e]||(this._state[this._id][e]={}),this._state[this._id][e][t]=1),this._isListenByAnotherTab(e,t)||this._stateChangeDelegate.fire("add",e,t),this._shareState()}removeChannel(e,t){this._isExist(e,t)&&(this._state[this._id][e][t]--,this._isNotEmpty(e,t)||this._removeChannel(e,t),this._shareState())}collectPushStreamChannels(e){const t=new Set;return Object.keys(this._state).forEach((s=>{const n=this._state[s][e];this._state[s][e]&&Object.keys(n).forEach((e=>t.add(e)))})),Array.from(t)}onStateChange(e){this._stateChangeDelegate.subscribe(null,e)}offStateChange(e){this._stateChangeDelegate.unsubscribe(null,e)}onTabCreate(e){this._onTabCreateCb=e}_isExist(e,t,s=this._id){return void 0!==this._state[s]&&void 0!==this._state[s][e]&&void 0!==this._state[s][e][t]}_isNotEmpty(e,t,s=this._id){return this._isExist(e,t,s)&&this._state[s][e][t]>0}_compareTabState(e,t,s,n){Object.keys(t).forEach((i=>{Object.keys(t[i]).forEach((t=>{this._isListenByAnotherTab(i,t,e)||s[i]&&s[i][t]||this._stateChangeDelegate.fire(n,i,t)}))}))}_isListenByAnotherTab(e,t,s=this._id){return Object.keys(this._state).some((n=>n!==s&&this._isNotEmpty(e,t,n)))}}const P=(0,_.getLogger)(d),T={url:window.PUSHSTREAM_URL,urlPath:"message-pipe-ws",transportType:p.WebSocket},N={url:window.PUSHSTREAM_URL.replace("wss://","https://"),urlPath:"message-pipe-es",transportType:p.EventSource};class k{constructor(){var e;this.guid=(0,b.guid)(),this._pushStreamPublic=null,this._pushStreamPrivate=null,this._statusHandlers=[],this._reconnectHandlers=[],this._userPrivateChannel=null,this._channelMultiplexer=new g,this._xEventPrefix="multiplexer-bc-",this._storagePrefix="pushStreamMultiplexerState.",this._userChannelPrefix="private_",this._statusPublic=o.ConnectionStatus.Closed,this._statusPrivate=o.ConnectionStatus.Closed,this._xEventSend=this._xEventPrefix+"send",this._xEventConnectionStatus=this._xEventPrefix+"connectionStatus",this._xEventReconnectCommand=this._xEventPrefix+"reconnectCommand",this._xEventReconnectSuccess=this._xEventPrefix+"reconnectSuccess",this._xEventRequestLogs=this._xEventPrefix+"requestLogs",this._xEventShareLogs=this._xEventPrefix+"shareLogs",this._state=new x,this._shareLogsKey=this._storagePrefix+"shareLogs",this._lockName="pushstream",this._lockPromise=(0,C.createDeferredPromise)(),this._dispatchReconnectSuccessCommandFromOther=e=>{if(this.ownPushStream())return;const[t]=this._decodeParams(e);this._callReconnectHandlers(t)},this._dispatchMessage=(e,t,s)=>{this._dispatchMessageToOthers(e,t,s),this._dispatchMessageToSelf(e,t,s,!1)},this._dispatchMessageFromOther=e=>{if(this.ownPushStream())return;const[t,s,n]=this._decodeParams(e);this._dispatchMessageToSelf(t,s,n,!0)},this._dispatchStatusChangeFromOther=e=>{const t=this._decodeConnectionStatus(e),s=t[0],n=t[1]
;this.ownPushStream()||this._dispatchStatusChangeToSelf(s,n)},this._dispatchReconnectCommandFromOther=()=>{this.ownPushStream()&&this.forceConnect()},this._onRequestLogs=()=>{if(this.ownPushStream()){const e=this._getOwnLogs();let t="";try{t=JSON.stringify(e)}catch(e){P.logError("Failed to stringify own pushstream logs")}r.TVLocalStorage.setItem(this._shareLogsKey,t),n.TVXWindowEvents.emit(this._xEventShareLogs,t)}},this._onStateChange=(e,t,s)=>{const n="private"===t?this._pushStreamPrivate:this._pushStreamPublic;"add"===e?n?.addChannel(s):n?.removeChannel(s)},this._onNewTabCreate=()=>{this._dispatchStatusChangeToOthers(this._statusPublic,this._statusPrivate)},E()?navigator.locks.request(this._lockName,(async()=>(this._state.onStateChange(this._onStateChange),this._state.onTabCreate(this._onNewTabCreate),this._instantiatePushStream(),window.addEventListener("beforeunload",(()=>this._lockPromise.resolve())),this._lockPromise.promise))):(this._state.onStateChange(this._onStateChange),this._instantiatePushStream()),n.TVXWindowEvents.on(this._xEventSend,this._dispatchMessageFromOther),n.TVXWindowEvents.on(this._xEventConnectionStatus,this._dispatchStatusChangeFromOther),n.TVXWindowEvents.on(this._xEventReconnectCommand,this._dispatchReconnectCommandFromOther),n.TVXWindowEvents.on(this._xEventReconnectSuccess,this._dispatchReconnectSuccessCommandFromOther),n.TVXWindowEvents.on(this._xEventRequestLogs,this._onRequestLogs),e=()=>{window.loginStateChange&&window.loginStateChange.subscribe(this,this._changeLoginState)},"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}on(e,t){this._channelMultiplexer.on(e,t)}off(e,t){this._channelMultiplexer.off(e,t)}onStatus(e){this._statusHandlers.push({handler:e,isPrivate:!1}),setTimeout((()=>e(this._statusPublic)),0)}onPrivateStatus(e){this._statusHandlers.push({handler:e,isPrivate:!0}),setTimeout((()=>e(this._statusPrivate)),0)}onReconnect(e,t=!1){this._reconnectHandlers.push({handler:e,isPrivate:t})}offReconnect(e){this._reconnectHandlers=this._reconnectHandlers.filter((t=>t.handler!==e))}offStatus(e){this._statusHandlers=this._statusHandlers.filter((t=>t.handler!==e))}forceConnect(){P.logNormal(`Creating pushstream connection after force connect. Main tab: ${this.ownPushStream()}`),this.ownPushStream()?(this._pushStreamPublic?.disconnect(),this._pushStreamPrivate?.disconnect(),this._instantiatePushStream()):n.TVXWindowEvents.emit(this._xEventReconnectCommand)}disconnect(){this.ownPushStream()&&this._destructPushStream()}getLogs(e){return new Promise((t=>{const s=setTimeout((()=>{const e=r.TVLocalStorage.getItem(this._shareLogsKey);t(null!==e?JSON.parse(e):[])}),1e3),i=e=>{let r;n.TVXWindowEvents.off(this._xEventShareLogs,i),n.TVXWindowEvents.emit(this._xEventShareLogs,""),clearTimeout(s);try{r=JSON.parse(e)}catch(e){r=[],P.logError("Failed to parse logs received from master tab")}t(r)};this.ownPushStream()?t(this._getOwnLogs(e)):(n.TVXWindowEvents.on(this._xEventShareLogs,i),n.TVXWindowEvents.emit(this._xEventRequestLogs))}))}ownPushStream(){
return!!this._pushStreamPublic||!!this._pushStreamPrivate}pushStream(){if(!this.ownPushStream())throw new Error("Not own PushStream");return this._pushStreamPublic}isConnected(){return this._statusPublic>0}status(){return this._statusPublic??o.ConnectionStatus.Closed}statusPrivate(){return this._statusPrivate??o.ConnectionStatus.Closed}userChannel(){if(!this._userPrivateChannel)throw new Error("No user channel");return this._userChannel(this._userPrivateChannel)}addChannel(e){this._state.addChannel(e.startsWith(this._userChannelPrefix)?"private":"public",e)}removeChannel(e){this._state.removeChannel(e.startsWith(this._userChannelPrefix)?"private":"public",e)}static getInstance(){return null===this._instance&&(this._instance=new k),this._instance}_userChannel(e){return this._userChannelPrefix+e}_codeParams(e){const t=[...e];return t.push((new Date).getTime()),JSON.stringify(t)}_decodeParams(e){const t=JSON.parse(e);return t.pop(),t}_instantiatePushStream(){this._pushStreamPublic&&((0,i.trackEvent)("PushstreamDoublePublic",window.user&&window.user.username||"Guest",navigator.userAgent),this._pushStreamPublic.disconnect());const e=this._getPushStreamSettings();this._pushStreamPublic=new f(this._dispatchMessage,e),this._pushStreamPublic.connectionStatus().subscribe((e=>{this._dispatchStatusChange(e,this._statusPrivate)})),this._pushStreamPublic.reconnectEvent().subscribe(null,(()=>{this._dispatchReconnectSuccessCommand()})),this._pushStreamPrivate&&((0,i.trackEvent)("PushstreamDoublePrivate",window.user&&window.user.username||"Guest",navigator.userAgent),this._pushStreamPrivate.disconnect()),this._pushStreamPrivate=new f(this._dispatchMessage,{...e,maxSize:1}),this._pushStreamPrivate.connectionStatus().subscribe((e=>{this._dispatchStatusChange(this._statusPublic,e)})),this._pushStreamPrivate.reconnectEvent().subscribe(null,(()=>{this._dispatchReconnectSuccessCommand(!0)})),this.on("pushstream_set_user_channel",(e=>{this._setUserChannel(e)})),this._connectChannels()}_destructPushStream(){const e=this._pushStreamPublic;this._pushStreamPublic=null,e?.disconnect();const t=this._pushStreamPrivate;this._pushStreamPrivate=null,t?.disconnect(),this._dispatchStatusChangeFromOther(this._codeParams([o.ConnectionStatus.Closed,o.ConnectionStatus.Closed]))}_connectChannels(){this._pushStreamPublic?.addChannel("public");const e=this._state.collectPushStreamChannels("public");void 0!==e&&e.length>0&&e.map((e=>this._pushStreamPublic?.addChannel(e))),"is_authenticated"in window?this._connectUserChannelInitial(!0):window.loginStateChange&&window.loginStateChange.subscribe(this,this._connectUserChannelInitial),this._isPublicPushstreamEnabled()&&this._pushStreamPublic?.connect()}_getPushStreamSettings(){return(0,y.isOnMobileAppPage)("any")?(0,v.isFeatureEnabled)("enable_eventsource_pushstream_mobile")?N:T:(0,v.isFeatureEnabled)("enable_eventsource_pushstream_transport")?N:T}_isPublicPushstreamEnabled(){return(0,y.isOnMobileAppPage)("any")||!(0,
v.isFeatureEnabled)("disable_pushstream_connections_for_anonymous_users")||window.is_authenticated||window.TradingView?.onChartPage}_connectUserChannelInitial(e){e&&(window.is_authenticated?(this._userPrivateChannel=window.user.private_channel??null,this._pushStreamPrivate?.addChannel(this.userChannel()),this._pushStreamPrivate?.connect()):this._userPrivateChannel=null)}_changeLoginState(e){e||(this._isPublicPushstreamEnabled()&&this._pushStreamPublic?.connect(),window.is_authenticated?(this._userPrivateChannel=window.user.private_channel??null,this.ownPushStream()&&(this._pushStreamPrivate?.addChannel(this.userChannel()),this._pushStreamPrivate?.connect())):(this.ownPushStream()&&(this._pushStreamPrivate?.removeChannel(this.userChannel()),this._pushStreamPrivate?.disconnect()),this._userPrivateChannel=null))}_setUserChannel(e){P.logNormal("Set user channel "+e),e!==this._userPrivateChannel&&(this.ownPushStream()&&this._userPrivateChannel&&this._pushStreamPrivate?.removeChannel(this.userChannel()),this._userPrivateChannel=e,this.ownPushStream()&&this._userPrivateChannel&&this._pushStreamPrivate?.addChannel(this.userChannel()))}_dispatchStatusChange(e,t){this._dispatchStatusChangeToOthers(e,t),this._dispatchStatusChangeToSelf(e,t)}_dispatchStatusChangeToSelf(e,t){e!==this._statusPublic&&(this._statusPublic=e,this._callStatusHandlers(e,!1)),t!==this._statusPrivate&&(this._statusPrivate=t,this._callStatusHandlers(t,!0))}_callStatusHandlers(e,t){P.logNormal("Connection status change: "+e+", private "+t+", is main tab "+this.ownPushStream()),a.telemetry.sendReport("site","pushstream_status_change"),this._statusHandlers.forEach((s=>{s.isPrivate===t&&s.handler(e)}))}_callReconnectHandlers(e){P.logNormal("Reconnection has been made"),this._reconnectHandlers.forEach((t=>{t.isPrivate===e&&t.handler()}))}_dispatchReconnectSuccessCommand(e=!1){if(this.ownPushStream()){this._callReconnectHandlers(e);const t=this._codeParams([e]);n.TVXWindowEvents.emit(this._xEventReconnectSuccess,t)}}_decodeConnectionStatus(e){const t=parseInt(e,10);return isNaN(t)?this._decodeParams(e):[t,t]}_dispatchStatusChangeToOthers(e,t){if(this.ownPushStream()){const s=this._codeParams([e,t]);n.TVXWindowEvents.emit(this._xEventConnectionStatus,s)}}_dispatchMessageToSelf(e,t,s,n){const i=e.channel,r=e.content;this._emit(r,t,i,n)}_dispatchMessageToOthers(e,t,s){const i=[e,t,s];n.TVXWindowEvents.emit(this._xEventSend,this._codeParams(i))}_emit(e,t,s,n){this._channelMultiplexer.emit(e,t,s,n)}_getOwnLogs(e){if(this.ownPushStream()){const t=(0,_.getRawLogHistory)(e,d),s=this.pushStream()?.getLogs();return[].concat(t,s??[])}return[]}}k._instance=null;const F=k.getInstance()},318557:(e,t,s)=>{"use strict";s.d(t,{contentHeight:()=>i.contentHeight,html:()=>r,outerHeight:()=>i.outerHeight,outerWidth:()=>i.outerWidth,position:()=>a});var n=s(650151),i=s(746326);function r(e,t){return void 0===t||(null===t&&(e.innerHTML=""),"string"!=typeof t&&"number"!=typeof t||(e.innerHTML=String(t))),e}function o(e){if(!e.getClientRects().length)return{top:0,left:0}
;const t=e.getBoundingClientRect(),s=(0,n.ensureNotNull)(e.ownerDocument.defaultView);return{top:t.top+s.pageYOffset,left:t.left+s.pageXOffset}}function a(e){const t=getComputedStyle(e);let s,n={top:0,left:0};if("fixed"===t.position)s=e.getBoundingClientRect();else{s=o(e);const t=e.ownerDocument;let i=e.offsetParent||t.documentElement;for(;i&&(i===t.body||i===t.documentElement)&&"static"===getComputedStyle(i).position;)i=i.parentElement;i&&i!==e&&1===i.nodeType&&(n=o(i),n.top+=parseFloat(getComputedStyle(i).borderTopWidth),n.left+=parseFloat(getComputedStyle(i).borderLeftWidth))}return{top:s.top-n.top-parseFloat(t.marginTop),left:s.left-n.left-parseFloat(t.marginLeft)}}},46277:(e,t,s)=>{"use strict";s.r(t),s.d(t,{DialogAction:()=>i,FeatureId:()=>n,createExtendedSolution:()=>_,errorCode:()=>o,trackSocialNetworkEvent:()=>a});var n,i,r=s(776734);!function(e){e.CreateIdea="free__create_public_idea",e.CreateComment="free__create_comment",e.CreateMessageChat="free__create_message_chat"}(n||(n={})),function(e){e.Open="open",e.OpenSolution="open_solution"}(i||(i={}));const o="permissions_denied";async function a(e,t){const s=await(0,r.getTracker)();if(s){const n=window.user.id?.toString();s.trackPermissionDialog(e,t,n||"")}}function _(e,t){const s=e.match(/\d+\//gm)?.[0];return e.replace(s||"",s+t)}},175203:(e,t,s)=>{"use strict";s.d(t,{telemetry:()=>c});var n=s(251924),i=s(954912),r=s(638456),o=s(314802);s(659863);const a=(0,s(735566).getLogger)("Common.Telemetry"),_={default:15e3,site:3e5},h=["before_websocket_connection_time_frame","websocket_connection_time_frame","first_series_full_time_frame","page_full_load_time_frame","page_load_time_frame"];const c=new class{constructor(){this.reportSent=new n.Delegate,this.timeCounters={series:{marks:[]},study:{},pine:{}},this._timeoutIds={},this._commonAdditionalData={cluster:null,userId:"0"},this._reportStash={}}setSessionInfo(e){const t=this._parseCluster(e);null!==t&&(this._commonAdditionalData.cluster=t)}sendReport(e,t,s){if(!this._isAbleToSendReport(t))return;const n=this._getSubserviceType(e),i=this._getHost(e,n);if(null!==i){if(s=void 0===s?{count:1}:s,this._addReportToStash(s,t,i),!this._timeoutIds[e]){const t=_[e]??_.default;this._timeoutIds[e]=setTimeout(this._sendTelemetryToService.bind(this,e,i),t)}}else a.logError(`Unable to get host for counter: ${t}, metric type: ${e}, serivce type: ${n}`)}sendChartReport(e,t,s=!0){this._sendServiceSpecifiedReport("charts",e,t,s)}sendLineToolsStorageReport(e,t,s=!0){this._sendServiceSpecifiedReport("line_tools_storage",e,t,s)}_sendServiceSpecifiedReport(e,t,s,n=!0){this._updateUserInfo(),s=void 0===s?{count:1}:s,n&&(s=this._appendCommonAdditionalInfo(s,["cluster","userId"])),this.sendReport(e,t,s)}_updateUserInfo(){const e="user"in window&&"id"in window.user?window.user.id:"0";this._commonAdditionalData.userId=String(e)}_isAbleToSendReport(e){const t=window.TELEMETRY_HOSTS,s=h.includes(e),n=Boolean(window.TradingView?.onChartPage||(0,r.onWidget)());return t&&(!s||n)}_sendTelemetryToService(e,t){
if(this._reportStash.hasOwnProperty(t)){const e=this._cropParams(this._reportStash[t]),s=this._renameAllParams(e),n={event:"report_stash",params:this._cleanAllParams(s)};a.logDebug(`Report to host: ${t}; stash: ${JSON.stringify(this._reportStash[t])}`),this.reportSent.fire(this._reportStash[t]),delete this._reportStash[t],(0,i.fetch)(`${t}/report`,{method:"POST",body:JSON.stringify(n)})}this._timeoutIds[e]=null}_getHost(e,t){const s=window.TELEMETRY_HOSTS,n=s[e]&&s[e][t];return Boolean(n)?n:null}_getSubserviceType(e){if(!["charts","site"].includes(e))return"all";let t="free";const s=window.user.is_pro;return"charts"===e&&(0,o.isOnMobileAppPage)("old")?t=s?"ios_pro":"ios_free":"charts"===e&&(0,o.isOnMobileAppPage)("new")?t=s?"android_pro":"android_free":(0,r.onWidget)()?t="widget":s&&(t="pro"),t}_parseCluster(e){let t;try{t=JSON.parse(e).session_id}catch(e){return a.logError("Could not parse cluster id (session id)"),null}const s=/(.*@)(.*)/gi.exec(t);return null!==s&&s.length>=3?s[2]:null}_appendCommonAdditionalInfo(e,t){return t.forEach((t=>{t in this._commonAdditionalData&&(e.additional=e.additional||{},e.additional[t]=this._commonAdditionalData[t])})),e}_cropParams(e){for(const t in e)e.hasOwnProperty(t)&&e[t].length>1e3&&(e.too_much_metrics_frame=e.too_much_metrics_frame??[],e.too_much_metrics_frame.push({value:e[t].length,additional:{event:t}}),delete e[t]);return e}_renameAllParams(e){const t={};for(const s in e)e.hasOwnProperty(s)&&(t[s]=[],e[s].forEach((e=>{t[s].push(this._renameEntryParams(e))})));return t}_renameEntryParams(e){const t={count:"c",value:"v",text:"t",additional:"a"};return Object.keys(e).reduce(((s,n)=>(s[t[n]]=e[n],s)),{})}_cleanAllParams(e){const t={};for(const s in e)if(e.hasOwnProperty(s)){t[s]=[];const n={c:0};e[s].forEach((e=>{const i=this._cleanEntryParams(e),r=Object.keys(i).length;1===r&&void 0!==i.c?n.c+=i.c:r>0&&t[s].push(i)})),n.c>0&&t[s].push(n),0===t[s].length&&delete t[s]}return t}_cleanEntryParams(e){const t=Object.keys(e).reduce(((t,s)=>"c"!==s&&"t"!==s||e[s]?(t[s]=e[s],t):t),{});return"c"in t||"v"in t||"t"in t?t:{}}_addReportToStash(e,t,s){s in this._reportStash||(this._reportStash[s]={}),t in this._reportStash[s]||(this._reportStash[s][t]=[]),Object.keys(e).length>0&&this._reportStash[s][t].push(e)}}},224743:(e,t,s)=>{"use strict";s.d(t,{globalCloseDelegate:()=>n,globalCloseMenu:()=>i});const n=new(s(251924).Delegate);function i(){n.fire()}},111495:(e,t,s)=>{"use strict";s.d(t,{getQuoteSessionInstance:()=>g,getQuoteSessionNoEnsure:()=>v});var n=s(920057),i=s(290484),r=s(391581),o=s(650151),a=s(978956),_=s(207639),h=s(900608),c=s(274210),l=s(761637),u=s(372988),d=s(332906);class m{constructor(e){this.onConnect=new a.Delegate,this.onDisconnect=new a.Delegate,this._connected=!1,this._subscriptions={},this._symbol_data={},this._delayUpdateFastSymbols=(0,i.default)(this._updateFastSymbols,250),this._throttledSymbolData={},this._extensions={},this.options={throttleTimeout:125,...e},this._session=new d.QuoteSession(e.api,["multiplexer",e.name,(0,
h.randomHash)()].filter(Boolean).join("_")),this.options.extensions?.formatter&&(this._extensions.formatter=this.options.extensions.formatter(this)),this.options.extensions?.snapshot&&(this._extensions.snapshot=this.options.extensions.snapshot(this)),this.connect()}destroy(){this._session.destroy(),this._connected=!1,this.onDisconnect.fire()}internals(){return{session:()=>this._session,subscriptions:()=>this._subscriptions,data:()=>this._symbol_data}}connect(){this._session.connect(this.quoteHandler.bind(this))}quoteHandler(e){const{method:t,params:s}=e;switch(t){case"connected":this._connected||(this._connected=!0,this.onConnected());break;case"quote_list_fields":break;case"quote_symbol_data":this._connected&&this.onSymbolData(s[0]);break;case"quote_completed":this._connected&&this.onSymbolData({symbolname:s[0],complete:performance.now(),values:{}});break;case"disconnected":this._connected&&(this._connected=!1,this.onDisconnect.fire())}}onConnected(){this.setFields();const e=Object.keys(this._symbol_data);e.length&&(this._session.quoteAddSymbols(e),this._delayUpdateFastSymbols()),this.onConnect.fire()}setFields(){const{fields:e}=this.options;e&&e.length&&this._session.quoteSetFields(e)}onSymbolData(e){try{e.status&&c.QUOTE_FIELDS_CACHE.update(e,c.QUOTE_FIELDS,!1)}catch(e){}const t=e.symbolname;let s=this._throttledSymbolData[t];(0,u.getNewPeveCloseMode)()&&(delete e.values.prev_close_price,void 0!==e.values.regular_close&&(e.values.prev_close_price=e.values.regular_close)),s||(s=this._throttledSymbolData[t]={fnDispatch:(0,n.default)(this.dispatchSymbolData.bind(this),this.options.throttleTimeout)}),s.cache?(0,_.deepExtend)(s.cache,e):s.cache=e,s.fnDispatch(t)}dispatchSymbolData(e){const t=this._symbol_data[e],s=this._throttledSymbolData[e].cache;if(delete this._throttledSymbolData[e].cache,this._symbol_data[e]){(0,_.deepExtend)(t,s),t.values&&this._parseUpdateMode(t.values);for(const n in this._subscriptions){const i=this._subscriptions[n];if(i.has(e)){[...(0,o.ensureDefined)(i.get(e))].forEach((e=>{e(t,s)}))}}}}subscribe(e,t,s){this._subscriptions[e]=this._subscriptions[e]||new Map;const n=this._subscriptions[e];t=Array.isArray(t)?[...t]:[t];const i=[];t.forEach((e=>{this._symbol_data[e]?n&&n.has(e)||this._symbol_data[e].subscribers_count++:(this._symbol_data[e]={subscribers_count:1},i.push(e)),n.has(e)||n.set(e,[]);const t=(0,o.ensureDefined)(n.get(e));t.push(s),t.fast=!0,this._symbol_data[e]&&this._symbol_data[e].values&&s(this._symbol_data[e],this._symbol_data[e])})),i.length&&this._connected&&(this._session.quoteAddSymbols(i),this._delayUpdateFastSymbols())}unsubscribe(e,t,s){t=Array.isArray(t)?[...t]:[t];const n=this._subscriptions[e],i=[];for(let r=0;r<t.length;r++){const a=t[r];if(n)if(n.has(a)&&s){const e=(0,o.ensureDefined)(n.get(a)),t=e.indexOf(s);~t&&e.splice(t,1),e.length||n.delete(a)}else n.delete(a);n&&0===n.size&&delete this._subscriptions[e],this._symbol_data.hasOwnProperty(a)&&(n&&!n.has(a)&&this._symbol_data[a].subscribers_count--,
this._symbol_data[a].subscribers_count||(delete this._symbol_data[a],i.push(a)))}i.length&&this._connected&&(this._session.quoteRemoveSymbols(i),this._delayUpdateFastSymbols())}setFastSymbols(e,t){if(this._subscriptions[e]){const s=this._subscriptions[e],n=Array.from(s.keys());for(let e=0;e<n.length;++e){const i=n[e];(0,o.ensureDefined)(s.get(i)).fast=-1!==t.indexOf(i)}}this._delayUpdateFastSymbols()}snapshot(e){return void 0===this._extensions.snapshot?Promise.reject("No formatter extension provided"):this._extensions.snapshot(e)}formatter(e,t){return void 0===this._extensions.formatter?Promise.reject("No formatter extension provided"):this._extensions.formatter(e,t)}_updateFastSymbols(){if(!this._connected)return;const e=this._fastSymbols();0===e.length?this._session.quoteHibernateAll():this._session.quoteFastSymbols(e)}_fastSymbols(){let e=[];for(const t in this._subscriptions){const s=this._subscriptions[t],n=Array.from(s.keys());for(let t=0;t<n.length;++t){const i=n[t];(0,o.ensureDefined)(s.get(i)).fast&&e.push(i)}}return e=(0,r.default)(e),e}_parseUpdateMode(e){(0,l.normalizeUpdateMode)(e)}}var p=s(339563);const f={};function g(e="full"){return f[e]||function(e="full",t){f[e]=t}(e,new m({name:e,api:window.ChartApiInstance,fields:b[e],extensions:{formatter:e=>new y(e).formatter,snapshot:e=>new S(e).snapshot}})),f[e]}function v(e="full"){return f[e]}const b={simple:["base-currency-logoid","ch","chp","currency-logoid","currency_code","currency_id","base_currency_id","current_session","description","exchange","format","fractional","is_tradable","language","local_description","listed_exchange","logoid","lp","lp_time","minmov","minmove2","original_name","pricescale","pro_name","short_name","type","typespecs","update_mode","volume","variable_tick_size","value_unit_id","unit_id","measure"]};b.simpleDetailed=[...b.simple,"ask","bid","fundamentals","high_price","is_tradable","low_price","open_price","prev_close_price","rch","rchp","rtc","rtc_time","status","basic_eps_net_income","beta_1_year","earnings_per_share_basic_ttm","industry","market_cap_basic","price_earnings_ttm","sector","volume","dividends_yield","timezone"],b.full=[],b.watchlist=[...b.simple,"rchp","rtc","country_code","provider_id","dividends_availability","financials_availability","earnings_availability"],b.portfolio=["pro_name","short_name","exchange","listed_exchange","description","local_description","language","sector","type","typespecs","industry","currency_code","currency_id","ch","chp","logoid","currency-logoid","base-currency-logoid","earnings_per_share_forecast_next_fq","earnings_release_next_date","earnings_release_date","earnings_per_share_fq","lp","fractional","minmov","minmove2","pricescale","volume","average_volume","market_cap_calc","market_cap_basic","total_revenue","earnings_per_share_basic_ttm","price_earnings_ttm","beta_1_year","dps_common_stock_prim_issue_fy","dividends_yield","fundamental_currency_code","rates_mc","rates_fy","rates_ttm","format","value_unit_id","unit_id","measure"],
b.notes=["short_name","pro_name","logoid","currency-logoid","base-currency-logoid","symbol-primaryname","type","typespecs"],b.estimates=["fundamental_data","type","typespecs","earnings_per_share_forecast_next_symbol_currency_fq","earnings_release_next_aligned_date","earnings_release_next_calendar_date","earnings_release_next_date"],b.economic=["reference-last-period","lp","currency_code","value_unit_id","unit_id","measure"],b.options=["ask","bid","lp","volume"];class y{constructor(e){this._formatterValuesCache={},this._waitingForFormatters={},this.formatter=(e,t)=>{if(this._waitingForFormatters[e])return this._waitingForFormatters[e];function s(e){const s=t&&!e.fractional?1:e.minmov;return new p.PriceFormatter({priceScale:e.pricescale,minMove:s,fractional:e.fractional,minMove2:e.minmove2})}const n=new Promise(((t,n)=>{if(this._formatterValuesCache[e])t(s(this._formatterValuesCache[e]));else{const i=(0,h.guid)();this._multiplexer.subscribe(i,[e],(r=>{"error"===r.status&&(this._waitingForFormatters[e]=null,n("Quotes snapshot is not received")),function(e){return e&&null!=e.pricescale&&null!=e.minmov}(r.values)&&(this._waitingForFormatters[e]=null,this._formatterValuesCache[e]=r.values,t(s(r.values)),this._multiplexer.unsubscribe(i,e))}))}}));return this._waitingForFormatters[e]=n,n},this._multiplexer=e}}class S{constructor(e){this._snapshotValuesCache={},this._waitingForSnapshot={},this.snapshot=e=>{if(this._waitingForSnapshot[e])return this._waitingForSnapshot[e];const t=new Promise(((t,s)=>{if(this._snapshotValuesCache[e])t(this._snapshotValuesCache[e]);else{const n=(0,h.guid)();this._multiplexer.subscribe(n,[e],(i=>{"error"===i.status&&(this._waitingForSnapshot[e]=null,s("Quotes snapshot is not received"));const r=i.values;r&&r.minmov&&r.pricescale&&r.description&&(this._waitingForSnapshot[e]=null,this._snapshotValuesCache[e]=r,t(r),this._multiplexer.unsubscribe(n,e))}))}}));return this._waitingForSnapshot[e]=t,t},this._multiplexer=e}}"undefined"!=typeof window&&(window.getQuoteSessionInstance=g)},483102:(e,t,s)=>{"use strict";function n(e){const t=Object.create(e);return t.release=()=>{},t.ownership=()=>t,t}function i(e){const t=e;return t.release=()=>t.destroy(),t.ownership=()=>t,t}s.d(t,{ownership:()=>i,weakReference:()=>n})},601316:(e,t,s)=>{"use strict";s.d(t,{getMinTick:()=>h,getMinTickData:()=>_,makePriceIndexToPriceConverter:()=>d,makePriceToPriceIndexConverter:()=>u,makeVariableMinTickData:()=>l});var n=s(960521),i=s(150335),r=s(405942),o=s(462140);function a(e){return e?(0,n.Big)(e.minMove).div(e.priceScale).toNumber():NaN}function _(e){const{minTick:t,price:s,variableMinTickData:n,shouldCheckForEquality:r}=e,o=(0,i.isNumber)(t)?c(t):t;return void 0===n?o:function(e,t,s=!1){for(let n=0;n<t.length;n++){if(e<t[n].price)return t[n].minTick;if(s&&e===t[n].price)return t[n].minTick}return t[t.length-1].minTick}(s,n,r)}function h(e){return a(_(e))}function c(e){const t=(0,r.numOfDecimalPlaces)(e),s=Math.pow(10,t);return{priceScale:s,minMove:(0,n.Big)(e).mul(s).toNumber()}}function l(e,t){const s=[{minTick:(0,
i.isNumber)(e)?c(e):e,price:1/0,maxIndex:1/0}];try{const e=t.split(" ").map(((e,t)=>(0,o.isEven)(t)?function(e){const t=Number(e);if(Number.isFinite(t))return c(t);{const t=e.split("/");if(t.length<2||t.length>3)throw new Error(`Unexpected mintick: ${e}`);const s=Number(t[1]),n=Number(t[0]);if(!Number.isFinite(s)||!Number.isFinite(n))throw new Error(`Unexpected mintick: ${e}`);const i=3===t.length?Number(t[2]):void 0;if(void 0!==i&&!Number.isFinite(i))throw new Error(`Unexpected mintick: ${e}`);const r={priceScale:s,minMove:n};return void 0!==i&&(r.minMove2=i),r}}(e):function(e){const t=Number(e);if(Number.isNaN(t))throw new Error(`Unexpected price limit: ${e}`);return t}(e)));if((0,o.isEven)(e.length))throw new Error("Theme must not be event number of elements");const s=[];for(let t=0;t<e.length;t+=2){const i=e[t+1]??1/0,r=s[s.length-1]?.price??0,o=s[s.length-1]?.maxIndex??0,_=i===1/0?1/0:new n.Big(i).minus(r).div(a(e[t])).plus(o).toNumber();s.push({minTick:e[t],price:i,maxIndex:_})}return s}catch{return s}}function u(e,t){return(s,i)=>{if(!Number.isFinite(s))return NaN;if(void 0===t)return new n.Big(s).div(e).mul(i??1).round().toNumber();for(let e=0;e<t.length;e++){const{price:i,minTick:r}=t[e],o=t[e-1]?.price??0,_=t[e-1]?.maxIndex??0;if(s<i)return new n.Big(s).minus(o).div(a(r)).plus(_).round().toNumber()}return NaN}}function d(e,t){return(s,i)=>{if(!Number.isFinite(s))return NaN;if(void 0===t)return(0,n.Big)(s).mul(e).mul(i??1).toNumber();for(let e=0;e<t.length;e++){const{maxIndex:i,minTick:r}=t[e],o=t[e-1]?.price??0,_=t[e-1]?.maxIndex??0;if(s<i)return new n.Big(s).minus(_).mul(a(r)).plus(o).toNumber()}return NaN}}},804805:(e,t,s)=>{"use strict";let n;s.d(t,{formatterOptions:()=>i,getNumberFormat:()=>c});const i={decimalSign:".",decimalSignFractional:"'"};const r={groupingSeparator:",",decimalSign:"."},o={groupingSeparator:".",decimalSign:","},a={groupingSeparator:"",decimalSign:","},_={groupingSeparator:"",decimalSign:"."},h=new Map([["en",r],["th",r],["ja",r],["ko",r],["zh",r],["zh_TW",r],["ar",r],["he_IL",r],["ms_MY",r],["vi",r],["de",o],["es",o],["it",o],["tr",o],["pt",o],["id_ID",o],["fr",a],["pl",a],["ru",a]]);function c(e){if(e)return{decimalSign:i.decimalSign,groupingSeparator:""};const t=n||window.language||"";return h.get(t)??_}},39485:(e,t,s)=>{"use strict";s.d(t,{NumericFormatter:()=>r});var n=s(114603),i=s(804805);class r{constructor(e={}){this._options=e}format(e,t={}){if(!Number.isFinite(e))return String(e);const{ignoreLocaleNumberFormat:s=this._options.ignoreLocaleNumberFormat,noExponentialForm:o=this._options.noExponentialForm}=t,{minPrecision:a,precision:_}=this._options,h=(0,i.getNumberFormat)(s);return void 0===_?r._formatNoEImpl(e,h,_,a):(0,n.formatNumber)(e,h,_,o,a)}parse(e,t){const{ignoreLocaleNumberFormat:s,precision:r}=this._options,o=(0,i.getNumberFormat)(s||t?.ignoreLocaleNumberFormat);let a=(0,n.parseNumber)(e,o);return Number.isFinite(a)?(r&&(a=+a.toFixed(r)),{res:!0,value:a}):{res:!1}}static formatNoE(e,t){return this._formatNoEImpl(e,t)}static _formatNoEImpl(e,t,s,i){
return Number.isFinite(e)?(t=t??{groupingSeparator:"",decimalSign:"."},(0,n.formatNumber)(e,t,s,!0,i)):String(e)}}},754032:(e,t,s)=>{"use strict";s.d(t,{PercentageFormatter:()=>o,formattingSymbol:()=>r});var n=s(339563),i=s(680574);const r="%";class o extends n.PriceFormatter{constructor(e={}){void 0!==e.decimalPlaces&&(e.priceScale=Math.pow(10,e.decimalPlaces)),super(e),this.type="percentage"}state(){return{...super.state(),percent:!0}}parse(e,t){return e=e.replace(r,""),super.parse(e,t)}format(e,t={}){const{useRtlFormat:s=!0}=t,n=super.format(e,{...t,useRtlFormat:!1})+r;return s?(0,i.forceLTRStr)(n):n}static serialize(e){return e.state()}static deserialize(e){return new o(e)}}},339563:(e,t,s)=>{"use strict";s.d(t,{PriceFormatter:()=>C,isFormatterHasForexAdditionalPrecision:()=>S});var n=s(960521),i=s(735566),r=s(650151),o=s(444372),a=s(601316),_=s(680574);const h=new RegExp(/^(-?)[0-9]+$/);function c(e,t,s,n){let i=0;if(e>0&&t>0){let t=e;for(s&&n&&(t/=n);t>1;)t/=10,i++}return i}function l(e,t,s){const n=(0,r.ensureNotNull)((0,a.getMinTickData)({price:s,minTick:null,variableMinTickData:t,shouldCheckForEquality:!0})),{priceScale:i,minMove:o,minMove2:_}=n;return{priceScale:i,minMove:o,fractionalLength:c(i,o,e,_)}}class u{constructor(e){this._formatterErrors={custom:o.t(null,void 0,s(366123)),fraction:o.t(null,void 0,s(339643)),secondFraction:o.t(null,void 0,s(370784))};const{priceScale:t,minMove:n,minMove2:i,ignoreMinMove:r,variableMinTick:_,fractionalLength:h}=e;this._priceScale=t,this._minMove=n,this._minMove2=i,this._ignoreMinMove=r,this._variableMinTickData=void 0===_?void 0:(0,a.makeVariableMinTickData)({priceScale:t,minMove:n,minMove2:i},_),this._fractionalLength=h}formatImpl(e,t={}){const{signPositive:s,signNegative:n=!0,tailSize:i,cutFractionalByPrecision:r=!1,useRtlFormat:o=!0,variableMinTickDataPrice:a,ignoreLocaleNumberFormat:h,noExponentialForm:c,removeAllEndingZeros:l}=t;let u="";e<0?u=!1===n?"":"":e&&!0===s&&(u="+");const d=this._formatUnsigned(Math.abs(e),{tailSize:i,cutFractionalByPrecision:r,variableMinTickDataPrice:a,ignoreLocaleNumberFormat:h,noExponentialForm:c,removeAllEndingZeros:l}),m="0"===d?d:u+d;return o?(0,_.forceLTRStr)(m):m}parse(e,t){return"+"===(e=(e=(0,_.stripLTRMarks)(e)).replace("","-"))[0]&&(e=e.substring(1)),this._parseUnsigned(e,t)}_removeEndingZeros(e,t){for(let s=0;s<t&&"0"===e[e.length-1];s++)e=e.substring(0,e.length-1);return e}}var d=s(114603),m=s(866893),p=s(804805);const f=(0,i.getLogger)("Chart.DecimalPriceFormatter");class g extends u{constructor(e){super(e);const{minMove2:t,ignoreLocaleNumberFormat:s,noExponentialForm:n}=e;void 0!==t&&10!==t&&0!==t&&1!==t&&f.logDebug("invalid minmove2"),this._ignoreLocaleNumberFormat=s,this._noExponentialForm=n}hasForexAdditionalPrecision(){return 10===this._minMove2}_parseUnsigned(e,t){return this._parseAsDecimal(e,t)}_formatUnsigned(e,t){const{tailSize:s,cutFractionalByPrecision:n=!1,variableMinTickDataPrice:i,ignoreLocaleNumberFormat:r,noExponentialForm:o,removeAllEndingZeros:a=!1}=t,_={price:Math.abs(e),priceScale:this._priceScale,
minMove:this._minMove,fractionalLength:this._fractionalLength,tailSize:s,cutFractionalByPrecision:n,ignoreLocaleNumberFormat:r,noExponentialForm:o,removeAllEndingZeros:a};return void 0!==this._variableMinTickData&&(Object.assign(_,l(!1,this._variableMinTickData,i??_.price)),this._ignoreMinMove&&(_.minMove=1)),this._formatAsDecimal(_)}_formatAsDecimal(e){const{price:t,priceScale:s,minMove:i,fractionalLength:r=0,tailSize:o=0,cutFractionalByPrecision:a,ignoreLocaleNumberFormat:_=this._ignoreLocaleNumberFormat,noExponentialForm:h=this._noExponentialForm,removeAllEndingZeros:c}=e,l=(0,p.getNumberFormat)(_);if(t>=1e21&&!h)return t.toString().replace(".",l.decimalSign);const u=Math.pow(10,o)*s/(a?1:i),f=1/u;let g;if(u>1)g=Math.floor(t);else{const e=Math.floor(Math.round(t/f)*f);g=0===Math.round((t-e)/f)?e:e+f}let v="";if(u>1){let e=a?new n.Big(t).mul(u).round(void 0,0).minus(new n.Big(g).mul(u)).toNumber():parseFloat((Math.round(t*u)-g*u).toFixed(r));e>=u&&(e-=u,g+=1),e=a?new n.Big(e).round(r,0).toNumber():parseFloat(e.toFixed(r))*i;const s=(0,m.numberToStringWithLeadingZero)(e,r+o);if(!h&&t<1&&r>=10&&s.startsWith("0000")){let e=4;for(let t=e;t<s.length&&"0"===s[t];t++)e++;const t=this._removeEndingZeros(s.slice(e),r);return""===t?"0":`0${l.decimalSign}${t}e-${e}`}const _=this._removeEndingZeros(s,c?s.length:o);v=_?l.decimalSign+_:_}const b=(0,d.formatNumber)(g,l,void 0,h);return b.includes("e")?b:b+v}_parseAsDecimal(e,t={}){const{ignoreLocaleNumberFormat:s}=t,n=(0,p.getNumberFormat)(this._ignoreLocaleNumberFormat||s),i=(0,d.parseNumber)(e,n);return Number.isFinite(i)?{value:i,res:!0,suggest:this.formatImpl(i)}:{error:this._formatterErrors.custom,res:!1}}}const v=(0,i.getLogger)("Chart.FractionalPriceFormatter");class b extends u{constructor(e){super(e);const{minMove2:t}=e;null!=t&&t>0&&2!==t&&4!==t&&8!==t&&v.logDebug("invalid minmove2")}hasForexAdditionalPrecision(){return!1}_parseUnsigned(e){return this._minMove2?this._parseAsDoubleFractional(e):this._parseAsSingleFractional(e)}_formatUnsigned(e,t){const{tailSize:s,variableMinTickDataPrice:n}=t,i={price:Math.abs(e),priceScale:this._priceScale,minMove:this._minMove,minMove2:this._minMove2,fractionalLength:(0,r.ensureDefined)(this._fractionalLength),tailSize:s};return void 0!==this._variableMinTickData&&Object.assign(i,l(!0,this._variableMinTickData,n??i.price)),this._formatAsFractional(i)}_parseAsSingleFractional(e){let t=h.exec(e);if(t){const t=parseFloat(e);return{value:t,res:!0,suggest:this.formatImpl(t)}}if(t=new RegExp("^(-?)([0-9]+)\\"+p.formatterOptions.decimalSignFractional+"([0-9]+)$").exec(e),t){const e=!!t[1],s=parseInt(t[2]),n=this._priceScale,i=this._patchFractPart(parseInt(t[3]),1,n);if(i>=n||i<0)return{error:this._formatterErrors.fraction,res:!1};let r=s+i/n;return e&&(r=-r),{value:r,res:!0,suggest:this.formatImpl(r)}}return{error:this._formatterErrors.custom,res:!1}}_parseAsDoubleFractional(e){let t=h.exec(e);if(t){const t=parseFloat(e);return{value:t,res:!0,suggest:this.formatImpl(t)}}
if(t=new RegExp("^(-?)([0-9]+)\\"+p.formatterOptions.decimalSignFractional+"([0-9]+)\\"+p.formatterOptions.decimalSignFractional+"([0-9]+)$").exec(e),t){const e=!!t[1],s=parseInt(t[2]),n=void 0!==this._minMove2&&null!==this._minMove2?this._minMove2:NaN,i=this._priceScale/n,r=this._minMove2,o=this._patchFractPart(parseInt(t[3]),1,i),a=this._patchFractPart(parseInt(t[4]),2,r);if(o>=i||o<0)return{error:this._formatterErrors.fraction,res:!1};if(null!=r&&a>=r||a<0)return{error:this._formatterErrors.secondFraction,res:!1};let _=null!=r?s+o/i+a/(i*r):NaN;return e&&(_=-_),{value:_,res:!0,suggest:this.formatImpl(_)}}return{error:this._formatterErrors.custom,res:!1}}_patchFractPart(e,t,s){const n={0:0,5:1},i={0:0,2:1,5:2,7:3},r={0:0,1:1,2:2,3:3,5:4,6:5,7:6,8:7};return 2===s?void 0===n[e]?-1:n[e]:4===s?void 0===i[e]?-1:i[e]:8===s&&2===t?void 0===r[e]?-1:r[e]:e}_formatAsFractional(e){const{price:t,tailSize:s,priceScale:n,minMove:i,minMove2:r,fractionalLength:o}=e,a=n/i;let _=Math.floor(t),h=s?Math.floor(t*a)-_*a:Math.round(t*a)-_*a;h===a&&(h=0,_+=1);let c="";if(s){let e=(t-_-h/a)*a;e=Math.round(e*Math.pow(10,s)),c=(0,m.numberToStringWithLeadingZero)(e,s),c=this._removeEndingZeros(c,s)}if(!o)throw new Error("_fractionalLength is not calculated");let l="";if(r){const e=h%r;h=(h-e)/r;const t=(0,m.numberToStringWithLeadingZero)(h,o),s=this._getFractPart(e,2,r);l=t+p.formatterOptions.decimalSignFractional+s}else h=this._getFractPart(h,1,n),l=(0,m.numberToStringWithLeadingZero)(h*i,o);return _.toString()+p.formatterOptions.decimalSignFractional+l+c}_getFractPart(e,t,s){const n=[0,5],i=[0,2,5,7],r=[0,1,2,3,5,6,7,8];return 2===s?void 0===n[e]?-1:n[e]:4===s?void 0===i[e]?-1:i[e]:8===s&&2===t?void 0===r[e]?-1:r[e]:e}}var y=s(536794);function S(e){return"hasForexAdditionalPrecision"in e}class C{constructor(e={}){this.type="price";const{minMove2:t,fractional:s,variableMinTick:n,ignoreMinMove:i,ignoreLocaleNumberFormat:r}=e,o=!e.minMove||i?1:e.minMove,a=(0,y.isNumber)(e.priceScale)&&(0,y.isInteger)(e.priceScale)?e.priceScale:100,_=c(a,o,s,t),h={...e,minMove:o,priceScale:a,fractionalLength:_};if(a<0)throw new TypeError("invalid base");this._priceScale=a,this._minMove=o,this._minMove2=t,this._fractional=s,this._variableMinTick=n,this._ignoreMinMove=i,this._fractionalLength=_,this._ignoreLocaleNumberFormat=r,this._noExponentialForm=e.noExponentialForm,this._implementation=s?new b(h):new g(h)}isFractional(){return!!this._fractional}state(){return{minMove:this._minMove,minMove2:this._minMove2,priceScale:this._priceScale,variableMinTick:this._variableMinTick,ignoreMinMove:this._ignoreMinMove,fractional:this._fractional,noExponentialForm:this._noExponentialForm}}formatChange(e,t,s){return this._implementation.formatImpl(e-t,{...s,variableMinTickDataPrice:Math.min(Math.abs(e),Math.abs(t))})}format(e,t){return this._implementation.formatImpl(e,t)}parse(e,t){return this._implementation.parse(e,t)}hasForexAdditionalPrecision(){return this._implementation.hasForexAdditionalPrecision()}static serialize(e){return e.state()}static deserialize(e){
return new C(e)}}},235614:(e,t,s)=>{"use strict";s.d(t,{PLACE_HOLDER:()=>o,VolumeFormatter:()=>h});var n=s(444372),i=s(39485),r=s(536794);const o="---",a=[{value:3,letter:"K"},{value:6,letter:"M"},{value:9,letter:"B"},{value:12,letter:"T"}];function _(e,t){const s=e-t;return a.find((e=>e.value>=s))??a[a.length-1]}class h{constructor(e={}){this.type="volume";const{precision:t=0,minPrecision:s=0,dimensionPrecision:n=2,dimensionMinPrecision:r=0,significantDigits:o=3,ignoreLocaleNumberFormat:a,noExponentialForm:_,removeSpaceBeforeDimension:h}=e;this._precision=t,this._formatter=new i.NumericFormatter({ignoreLocaleNumberFormat:a,precision:this._precision,minPrecision:s,noExponentialForm:_}),this._dimensionPrecision=n,this._dimensionFormatter=new i.NumericFormatter({ignoreLocaleNumberFormat:a,precision:this._dimensionPrecision,minPrecision:r,noExponentialForm:_}),this._significantDigits=o,this._fractionalValues=void 0!==t&&t>0,this._spaceBeforeDimension=h?"":"",this._options=e}state(){const{ignoreLocaleNumberFormat:e,...t}=this._options;return t}format(e,t){if(!(0,r.isNumber)(e))return o;if(Math.abs(e)>=1e100)return n.t(null,void 0,s(696935));let i="";Math.abs(e)<1&&(e=+e.toFixed(this._precision)),e<0?i="":e>0&&t?.signPositive&&(i="+"),e=Math.abs(e);const a=!!(t?.ignoreLocaleNumberFormat??this._options.ignoreLocaleNumberFormat);let h,c,l=Math.floor(Math.log10(e))+1;if(l<=this._significantDigits&&(e=+e.toFixed(this._precision),l=Math.floor(Math.log10(e))+1),l<=this._significantDigits)h=this._formatNumber(e,a,this._formatter);else{let t=_(l,this._significantDigits);const s=Math.pow(10,t.value);e=+(e/s).toFixed(this._dimensionPrecision)*s,t=_(Math.floor(Math.log10(e))+1,this._significantDigits),h=this._formatNumber(e/Math.pow(10,t.value),a,this._dimensionFormatter),c=t.letter}return c?`${i}${h}${this._spaceBeforeDimension}${c}`:`${i}${h}`}parse(e,t){if("---"===e)return{error:"not a number",res:!1,value:NaN};const s={K:1e3,M:1e6,B:1e9,T:1e12},n=(e=e.replace("","-")).slice(-1);if(s.hasOwnProperty(n)){const i=this._formatter.parse(e.slice(0,-1).trim(),t),o=i.res?i.value:NaN;return(0,r.isNumber)(o)?{res:!0,value:o*s[n]}:{error:"not a number",res:!1,value:NaN}}{const s=this._formatter.parse(e.trim(),t);let n=s.res?s.value:NaN;return-0===n&&(n=0),(0,r.isNumber)(n)?{res:!0,value:n}:{error:"not a number",res:!1,value:NaN}}}static serialize(e){return e.state()}static deserialize(e){return new h(e)}_formatNumber(e,t,s){if(this._fractionalValues&&0!==e){const t=14-Math.ceil(Math.log10(e)),s=Math.pow(10,t);e=Math.round(e*s)/s}return s.format(e,{ignoreLocaleNumberFormat:t})}}},673378:(e,t,s)=>{"use strict";s.d(t,{createPrimitiveProperty:()=>i});var n=s(751610);function i(e){return new n.Property(e)}},57408:(e,t,s)=>{"use strict";s.d(t,{PropertyBase:()=>r});var n=s(650151),i=s(251924);class r{constructor(){this._listeners=new i.Delegate,this._muteChildChanges=!1,this._owner=null,this._name=""}nameInOwner(){return this._name}setNameInOwner(e){this._name=e}owner(){return this._owner}setOwner(e){this._owner=e}pathToRoot(){
const e=this._owner?.pathToRoot();return e?`${e}.${this._name}`:this._name}pathToRootProperty(){if(!this._owner)return"";const e=this._owner.pathToRootProperty?.();return e?`${e}.${this._name}`:this._name}removeProperty(e){(0,n.assert)(!1,`Trying to call "removeProperty" on property ${this.pathToRoot()}`)}addChild(e,t){(0,n.assert)(!1,`Trying to call "addChild" on property ${this.pathToRoot()}`)}hasChild(e){return!1}childCount(){return 0}childNames(){return[]}childs(){(0,n.assert)(!1,`Trying to call "childs" on property ${this.pathToRoot()}`)}state(e,t){return this.value()}merge(e,t){(0,n.assert)(!1,`Trying to call "merge" on property ${this.pathToRoot()}`)}mergeAndFire(e){(0,n.assert)(!1,`Trying to call "mergeAndFire" on property ${this.pathToRoot()}`)}child(e){if(this.hasChild(e))return this.childs()[e]}muteChildChanges(e){this._muteChildChanges=e}fireChanged(){this._listeners.fire(this,this.pathToRootProperty())}listeners(){return this._listeners}subscribe(e,t){this.listeners().subscribe(e,t,!1)}unsubscribe(e,t){this.listeners().unsubscribe(e,t)}unsubscribeAll(e){this.listeners().unsubscribeAll(e)}}},113640:(e,t,s)=>{"use strict";s.d(t,{DataTypes:()=>n,createPropertySchema:()=>p,dataType:()=>l,extractStateWithSchema:()=>f,isArraySchema:()=>m,validateSchema:()=>d});var n,i=s(569708),r=s(283873),o=s(683350),a=s(456052),_=s(182433),h=s(936714),c=s(650151);function l(e){return(0,i.default)(e)?n.NUMBER:(0,r.default)(e)?n.STRING:(0,o.default)(e)?n.BOOLEAN:(0,a.default)(e)?n.ARRAY:null===e?n.NULL:"object"==typeof e?n.OBJECT:n.UNKNOWN}!function(e){e.STRING="string",e.NUMBER="number",e.BOOLEAN="boolean",e.OBJECT="object",e.ARRAY="array",e.NULL="null",e.UNKNOWN="unknown"}(n||(n={}));const u=[n.ARRAY,n.OBJECT];function d(e,t){try{const s=l(e);if((0,c.assert)(s===t.type||s===n.NULL&&t.nullable||t.type===n.UNKNOWN),u.includes(s))switch(t.type){case n.ARRAY:(0,c.assert)(e.every((e=>d(e,t.subschema))));break;case n.OBJECT:for(const[s,n]of Object.entries(t.subschema))(0,c.assert)(d(e[s],n))}return!0}catch{return!1}}function m(e){return e.type===n.ARRAY}function p(e,t){let s;const i=l(e);switch(i){case n.NUMBER:case n.STRING:case n.BOOLEAN:s={type:i,saveFlags:t};break;case n.ARRAY:s={type:n.ARRAY,saveFlags:t,subschema:p(e[0],t)};break;case n.OBJECT:{const i={};for(const[s,n]of Object.entries(e))i[s]=p(n,t);s={type:n.OBJECT,saveFlags:t,subschema:i};break}default:s={type:n.UNKNOWN,saveFlags:t}}return s}function f(e,t,s){if(!function(e){return e.type===n.OBJECT}(t)||!(0,_.default)(e))return e;const i=Object.keys(e);for(const n of i){const i=t.subschema[n];void 0===t.saveFlags||i||(0,h.default)(e,n);const r=i?.saveFlags;void 0===r||r&s||(0,h.default)(e,n),i&&f(e[n],i,s)}return e}},751610:(e,t,s)=>{"use strict";s.d(t,{Property:()=>p,isPrimitiveType:()=>m});var n=s(569708),i=s(283873),r=s(683350),o=s(688987),a=s(456052),_=s(650151),h=s(735566),c=s(483102),l=s(57408),u=s(113640);const d=(0,h.getLogger)("Property");function m(e){return null===e||(0,n.default)(e)&&Number.isFinite(e)||(0,i.default)(e)||(0,r.default)(e)}
class p extends l.PropertyBase{constructor(e,t){if(super(),this._childs=[],this._dependents=[],this._schema=t||(0,u.createPropertySchema)(e),void 0!==e)if((0,u.validateSchema)(e,this._schema)||d.logWarn(`The state with a data type: ${(0,u.dataType)(e)} does not match a schema`),m(e))this._value=e;else{let t=Object.entries(e);(0,u.isArraySchema)(this._schema)&&(t=t.filter((([e])=>!Number.isNaN(+e))));for(const[e,s]of t)this.addProperty(e,s)}}destroy(){this.listeners().destroy();for(const e of this._childs)this.child(e)?.destroy?.()}merge(e,t){let s=null,n=0;if(t&&(s=[],n=s.length),void 0===e)return s;if(m(e))return this._value!==e&&s?.push(this),this._value=e,s;if((0,a.default)(e)){(0,u.isArraySchema)(this._schema)||d.logWarn("Property is not an array");for(let n=0;n<e.length;n++){const i=this.childs()[n];if(i){const r=i.merge(e[n],t);s?.push(...r)}else{const t=this.addProperty(`${n}`,e[n]);s?.push(t)}}}else{let n=Object.entries(e);(0,u.isArraySchema)(this._schema)&&(n=n.filter((([e])=>!Number.isNaN(+e))));for(const[e,i]of n){const n=this.childs()[e];if(n){const e=n.merge(i,t);s?.push(...e)}else{const t=this.addProperty(e,i);s?.push(t)}}}return s&&s.length>n&&s.push(this),s}mergeAndFire(e){const t=(0,_.ensureNotNull)(this.merge(e,!0));this._fireMergeAndFireChangedProps(t)}state(e,t){const s=(0,o.default)(this.value)?this.value():void 0;if(void 0!==s)return s;const n=(0,u.isArraySchema)(this._schema)?[]:{};for(const s of this._childs){if(e&&-1!==e.indexOf(s))continue;if((0,u.isArraySchema)(this._schema)&&Number.isNaN(+s))continue;if(void 0!==t&&"subschema"in this._schema){const e=(0,u.isArraySchema)(this._schema)?this._schema.subschema:this._schema.subschema[s];if(void 0!==this._schema.saveFlags&&!e)continue;if(void 0!==e?.saveFlags&&!(e.saveFlags&t))continue}const i=this.childs()[s];let r;if(e){const n=[];for(const t of e)t.startsWith(s+".")&&n.push(t.substring(s.length+1));r=i?.state(n,t)}else r=i?.state();(void 0!==r||i?.storeStateIfUndefined())&&((0,a.default)(n)?n[+s]=r:n[s]=r)}return n}clone(){return new p(this.state())}value(){return this._value}childCount(){return this._childs.length}childNames(){return this._childs}childByPath(e){let t=this;for(const s of e.split(".")){if(void 0===t)break;t=t.child(s)}return t}hasChild(e){return this._childs.includes(e)}setValue(e,t){(this._value!==e||t)&&(this._value=e,this.fireChanged())}setValueSilently(e){this._value=e}addProperty(e,t){let s;(0,u.isArraySchema)(this._schema)&&Number.isNaN(+e)&&d.logWarn("Property is an array"),this.removeProperty(e),this._schema.type===u.DataTypes.OBJECT?s=this._schema.subschema[e]:this._schema.type===u.DataTypes.ARRAY&&(s=this._schema.subschema);const n=new p(t,s);return this[e]=n,this._childs.push(e),n.subscribe(this,((e,t)=>{this._childChanged(e,t)})),n.setOwner(this),n.setNameInOwner(e),n}removeProperty(e){const t=this.child(e);t&&(t.setNameInOwner(""),t.setOwner(null),t.unsubscribeAll(this),delete this[e],this._childs=this._childs.filter((t=>t!==e)))}addChild(e,t){if((0,
u.isArraySchema)(this._schema)&&Number.isNaN(+e))throw new Error("Property is an array");this[e]&&this.removeProperty(e),this[e]=t,-1===this._childs.indexOf(e)&&this._childs.push(e),t.subscribe(this,((e,t)=>this._childChanged(e,t))),t.setOwner(this),t.setNameInOwner(e)}childs(){return this}storeStateIfUndefined(){return!0}ownership(){return(0,c.ownership)(this)}weakReference(){return(0,c.weakReference)(this)}addDependent(e){this._dependents.push(e)}removeDependent(e){const t=this._dependents.indexOf(e);t>=0&&this._dependents.splice(t,1)}dependents(){return this._dependents}_childChanged(e,t){this._muteChildChanges||this._listeners.fire(this,t)}_fireMergeAndFireChangedProps(e){this.muteChildChanges(!0);for(const t of e)t.muteChildChanges(!0);for(const t of e)t.muteChildChanges(!1),t.fireChanged();this.muteChildChanges(!1)}}},666054:(e,t,s)=>{"use strict";var n;s.d(t,{ConnectionStatus:()=>n}),function(e){e[e.Closed=0]="Closed",e[e.Connecting=1]="Connecting",e[e.Open=2]="Open"}(n||(n={}))},798266:(e,t,s)=>{"use strict";s.d(t,{PersistentEventSourceTransport:()=>a});var n=s(735566),i=s(666054),r=s(840940);const o=(0,n.getLogger)("PersistentWebsocketTransport");class a extends r.PersistentTransport{constructor(e){super(e,o),this._specializedErrorHandlerBound=this._specializedErrorHandler.bind(this)}_createNativeTransport(e){const t=new EventSource(e,{withCredentials:!0});return t.addEventListener("error",this._specializedErrorHandlerBound),t.addEventListener("open",this._socketOpenHandler),t.addEventListener("message",this._socketMessageHandler),t}_disconnectTransport(){if(null===this._socket)return;this._socket.removeEventListener("error",this._specializedErrorHandlerBound),this._socket.removeEventListener("open",this._socketOpenHandler),this._socket.removeEventListener("message",this._socketMessageHandler),this._removeOnOfflineListener();const e=this._socket;this._socket=null,this._connectionStatus.setValue(i.ConnectionStatus.Closed),e.readyState!==WebSocket.CLOSED&&e.close()}_specializedErrorHandler(e){e.eventPhase===EventSource.CLOSED?this._socketCloseHandler(e):this._socketErrorHandler()}}},840940:(e,t,s)=>{"use strict";s.d(t,{PersistentTransport:()=>_});var n=s(666054),i=s(137068),r=s(77294),o=s(251924),a=s(357517);class _{constructor(e,t,s){this._url="",this._socket=null,this._reconnectCount=0,this._onlineCancellationToken=null,this._connectionStatus=new r.WatchedValue(n.ConnectionStatus.Closed),this._socketCloseHandler=this._onCloseCallback.bind(this),this._socketErrorHandler=this._onErrorCallback.bind(this),this._socketOpenHandler=this._onOpenCallback.bind(this),this._socketMessageHandler=this._onMessageCallback.bind(this),this._maxReconnectReachedEventDelegate=new o.Delegate,this._successReconnectReachedEventDelegate=new o.Delegate,this._shouldReconnect=!0,this._maxReconnectCount=null,this._reconnectTimeoutId=0,this._connectAbortController=null,this._tryReconnect=()=>{if(this._disconnect(),this._shouldReconnect){const e=this._getReconnectTimeout()
;this._logger.logNormal(`Sleeping some time before reconnect ${e}ms`),this._reconnectTimeoutId=setTimeout(this._tryReconnectImpl.bind(this),e)}else this._logger.logNormal("Skip reconnecting because of shouldReconnect state")},this._onOfflineHandler=()=>{this._removeOnOfflineListener(),this._logger.logInfo("Network status changed to offline - trying to reconnect"),this._tryReconnect()},this._logger=t,this._messageHandler=e,this._closeHandler=s,window.addEventListener("unload",(()=>{t.logNormal("Unload event comes - disconnecting without reconnect after that..."),this._shouldReconnect=!1,this._disconnect()}),!1)}setUrl(e){if(this._url===e)return Promise.resolve();const t=this._connectionStatus.value()!==n.ConnectionStatus.Closed;return t&&this._disconnect(),this._url=e,t?this.connect():Promise.resolve()}url(){return this._url}connect(){return this._connectImpl()}setMaxReconnectCount(e){this._maxReconnectCount=e}connectionStatus(){return this._connectionStatus.readonly()}disconnect(){this._shouldReconnect=!1,this._disconnect()}maxReconnectReachedEvent(){return this._maxReconnectReachedEventDelegate}successReconnectReachedEvent(){return this._successReconnectReachedEventDelegate}async _prepareParamsForConnection(e){}_disconnect(){this._connectAbortController?.abort(),this._connectAbortController=null,clearTimeout(this._reconnectTimeoutId),this._reconnectTimeoutId=0,this._connectionStatus.value()!==n.ConnectionStatus.Closed?this._socket?(this._logger.logNormal(`Closing connection to: ${this._socket.url}, currentStatus: ${n.ConnectionStatus[this._connectionStatus.value()]}`),this._disconnectTransport()):this._logger.logNormal("Disconnecting without socket - probably within preparing, it should be already scheduled for aborting"):this._logger.logNormal("Attempt to close connection but it is closed already")}_onErrorCallback(){this._logger.logInfo("Connection is closed by error"),this._tryReconnect()}_onCloseCallback(e){this._logger.logInfo(`Connection is closed - code=${e.code} msg=${e.reason}`),this._closeHandler?.(e),this._tryReconnect()}_tryReconnectImpl(){return null!==this._maxReconnectCount&&this._reconnectCount===this._maxReconnectCount?(this._logger.logWarn("Maximum attempts to reconnect to websocket reached"),void this._maxReconnectReachedEventDelegate.fire()):(this._reconnectCount+=1,this._logger.logInfo(`Reconnecting count: ${this._reconnectCount}`),navigator.onLine?(this._logger.logInfo("Network status: online - trying to connect"),void this.connect()):(this._logger.logInfo("Network status: offline - wait until online"),void(this._onlineCancellationToken=(0,i.callWhenOnline)((()=>{this._logger.logInfo("Network status changed to online - trying to connect"),this.connect()})))))}_onOpenCallback(){this._logger.logNormal("Connection opened"),this._reconnectCount>0&&this._successReconnectReachedEventDelegate.fire(),this._reconnectCount=0,this._connectionStatus.setValue(n.ConnectionStatus.Open)}_onMessageCallback(e){this._messageHandler(e.data)}_getReconnectTimeout(){return this._reconnectCount<5?300:5e3}
_setOnOfflineListener(){window.addEventListener("offline",this._onOfflineHandler)}_removeOnOfflineListener(){window.removeEventListener("offline",this._onOfflineHandler)}async _connectImpl(){if(this._connectionStatus.value()!==n.ConnectionStatus.Closed)return void this._logger.logNormal("Attempt to open connection but it is not closed");this._socket&&(this._logger.logError("Something went wrong - code 0x2"),this.disconnect()),this._onlineCancellationToken&&(this._onlineCancellationToken(),this._onlineCancellationToken=null),this._logger.logNormal(`Connecting to ${this._url}`),this._shouldReconnect=!0,this._connectAbortController=new AbortController;const e=this._connectAbortController.signal;try{if(this._connectionStatus.setValue(n.ConnectionStatus.Connecting),await this._prepareParamsForConnection(e),e.aborted)throw(0,a.createAbortError)();this._socket=this._createNativeTransport(this._url),this._setOnOfflineListener()}catch(e){this._connectionStatus.setValue(n.ConnectionStatus.Closed),(0,a.skipAbortError)(e)}finally{this._connectAbortController=null}}}},420021:(e,t,s)=>{"use strict";s.d(t,{PersistentWebsocketTransport:()=>a});var n=s(735566),i=s(666054),r=s(840940);const o=(0,n.getLogger)("PersistentWebsocketTransport");class a extends r.PersistentTransport{constructor(e,t){super(e,o,t)}sendMessage(e){this._connectionStatus.value()===i.ConnectionStatus.Open?this._socket?this._socket.send(e):o.logError("Something went wrong - code 0x3"):o.logWarn("Attempt to send message but connection is not opened")}_createNativeTransport(e){const t=new WebSocket(e);return t.binaryType="arraybuffer",t.addEventListener("error",this._socketErrorHandler),t.addEventListener("close",this._socketCloseHandler),t.addEventListener("open",this._socketOpenHandler),t.addEventListener("message",this._socketMessageHandler),t}_disconnectTransport(){if(null===this._socket)return;this._socket.removeEventListener("error",this._socketErrorHandler),this._socket.removeEventListener("close",this._socketCloseHandler),this._socket.removeEventListener("open",this._socketOpenHandler),this._socket.removeEventListener("message",this._socketMessageHandler),this._removeOnOfflineListener();const e=this._socket;this._socket=null,this._connectionStatus.setValue(i.ConnectionStatus.Closed),e.readyState!==WebSocket.CLOSED&&e.close()}}},225627:(e,t,s)=>{"use strict";s.d(t,{CubicBezier:()=>n.CubicBezier,color:()=>n.color,dur:()=>n.dur,easingFunc:()=>n.easingFunc});var n=s(745269)},137068:(e,t,s)=>{"use strict";s.d(t,{callWhenOnline:()=>i,waitForOnline:()=>r});var n=s(357517);function i(e){let t=e;const s=()=>{window.removeEventListener("online",s),t&&t()};return window.addEventListener("online",s),()=>{t=null}}async function r(e=null){return!0===navigator.onLine||void 0===navigator.onLine?Promise.resolve():(0,n.respectAbort)(e,new Promise((e=>{const t=()=>{window.removeEventListener("online",t),e()};window.addEventListener("online",t)})))}}}]);